Description: Make the Makefile honor $(DESTDIR)
 The Makefile does not honor the $(DESTDIR) environment variable
 which is used to build Debian packages (see [1]).
 .
 * doc/Makefile.in: Add $(DESTDIR) to install targets
 * etc/Makefile.in: Same
 * src/Makefile.in: Same

 [1] http://www.gnu.org/prep/standards/standards.html#DESTDIR

Forwarded: not-needed
Author: Arno TÃ¶ll <debian@toell.net>

--- a/doc/Makefile.in
+++ b/doc/Makefile.in
@@ -39,21 +39,21 @@
 	done
 
 install: install-dirs
-	install -c -m 0644 istgt.1 $(mandir)/man1/
-	-rm -f $(mandir)/man1/istgt.1.gz
-	gzip -9 $(mandir)/man1/istgt.1
+	install -c -m 0644 istgt.1 $(DESTDIR)/$(mandir)/man1/
+	-rm -f $(DESTDIR)/$(mandir)/man1/istgt.1.gz
+	gzip -9 $(DESTDIR)/$(mandir)/man1/istgt.1
 
 install-doc: install-doc-dirs
-	install -c -m 0644 $(top_srcdir)/README $(datadir)/doc/istgt/
-	install -c -m 0644 $(top_srcdir)/ChangeLog.jp $(datadir)/doc/istgt/
-	install -c -m 0644 QUICKSTART $(datadir)/doc/istgt/
-	install -c -m 0644 QUICKSTART.jp $(datadir)/doc/istgt/
+	install -c -m 0644 $(top_srcdir)/README $(DESTDIR)/$(datadir)/doc/istgt/
+	install -c -m 0644 $(top_srcdir)/ChangeLog.jp $(DESTDIR)/$(datadir)/doc/istgt/
+	install -c -m 0644 QUICKSTART $(DESTDIR)/$(datadir)/doc/istgt/
+	install -c -m 0644 QUICKSTART.jp $(DESTDIR)/$(datadir)/doc/istgt/
 
 install-dirs:
-	mkdir -p $(mandir)/man1
+	mkdir -p $(DESTDIR)/$(mandir)/man1
 
 install-doc-dirs:
-	mkdir -p $(datadir)/doc/istgt
+	mkdir -p $(DESTDIR)/$(datadir)/doc/istgt
 
 clean:
 	-rm -f istgt.1
--- a/etc/Makefile.in
+++ b/etc/Makefile.in
@@ -44,19 +44,19 @@
 	done
 
 install: install-dirs
-	install -c -m 0644 istgt.conf $(sysconfdir)/istgt/istgt.conf.sample
+	install -c -m 0644 istgt.conf $(DESTDIR)/$(sysconfdir)/istgt/istgt.conf.sample
 	install -c -m 0644 istgt.large.conf \
-	$(sysconfdir)/istgt/istgt.large.conf.sample
-	install -c -m 0600 auth.conf $(sysconfdir)/istgt/auth.conf.sample
-	install -c -m 0600 istgtcontrol.conf $(sysconfdir)/istgt/istgtcontrol.conf.sample
+	$(DESTDIR)/$(sysconfdir)/istgt/istgt.large.conf.sample
+	install -c -m 0600 auth.conf $(DESTDIR)/$(sysconfdir)/istgt/auth.conf.sample
+	install -c -m 0600 istgtcontrol.conf $(DESTDIR)/$(sysconfdir)/istgt/istgtcontrol.conf.sample
 #	if [ ! -f $(sysconfdir)/rc.d/istgt ]; then \
 #	  install -c -m 0555 istgt.sh $(sysconfdir)/rc.d/istgt; \
 #	fi
-	install -c -m 0555 istgt.sh $(sysconfdir)/rc.d/istgt
+	install -c -m 0555 istgt.sh $(DESTDIR)/$(sysconfdir)/rc.d/istgt
 
 install-dirs:
-	mkdir -p $(sysconfdir)/istgt
-	mkdir -p $(sysconfdir)/rc.d
+	mkdir -p $(DESTDIR)/$(sysconfdir)/istgt
+	mkdir -p $(DESTDIR)/$(sysconfdir)/rc.d
 
 clean:
 	-rm -f istgt.large.conf istgt.conf istgt.sh
--- a/src/Makefile.in
+++ b/src/Makefile.in
@@ -83,11 +83,11 @@
 	$(CC) $(LDFLAGS) $(LIBS) -o $@ $(ISTGTCONTROL)
 
 install: install-dirs
-	install -c -m 0755 istgt $(bindir)
-	install -c -m 0755 istgtcontrol $(bindir)
+	install -c -m 0755 istgt $(DESTDIR)/$(bindir)
+	install -c -m 0755 istgtcontrol $(DESTDIR)/$(bindir)
 
 install-dirs:
-	mkdir -p $(bindir)
+	mkdir -p $(DESTDIR)/$(bindir)
 
 dist: $(DISTFILES)
 	mkdir $(DISTDIR)/$(subdir)
