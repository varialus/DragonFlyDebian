--- a/sys/conf/kern.mk
+++ b/sys/conf/kern.mk
@@ -1,11 +1,20 @@
 # $FreeBSD$
 
+.if ${CC:T:Mclang} != "clang"
+FREEBSD_GCC!=  ${CC} --version | grep FreeBSD || true
+.endif
+
 #
 # Warning flags for compiling the kernel and components of the kernel:
 #
+.if ${FREEBSD_GCC}
+# FreeBSD extensions, not available in upstream GCC
+format_extensions=     -fformat-extensions
+no_align_long_strings= -mno-align-long-strings
+.endif
 CWARNFLAGS?=	-Wall -Wredundant-decls -Wnested-externs -Wstrict-prototypes \
 		-Wmissing-prototypes -Wpointer-arith -Winline -Wcast-qual \
-		-Wundef -Wno-pointer-sign -fformat-extensions \
+		-Wundef -Wno-pointer-sign ${format_extensions} \
 		-Wmissing-include-dirs -fdiagnostics-show-option \
 		${CWARNEXTRA}
 #
@@ -48,7 +57,7 @@
 #
 .if ${MACHINE_CPUARCH} == "i386"
 .if ${CC:T:Mclang} != "clang"
-CFLAGS+=	-mno-align-long-strings -mpreferred-stack-boundary=2 -mno-sse
+CFLAGS+=	${no_align_long_strings} -mpreferred-stack-boundary=2 -mno-sse
 .else
 CFLAGS+=	-mno-aes -mno-avx
 .endif
