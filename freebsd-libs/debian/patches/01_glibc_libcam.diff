diff -ur lib.old/libcam/Makefile lib/libcam/Makefile
--- lib.old/libcam/Makefile	2004-02-05 23:44:22.000000000 +0100
+++ lib/libcam/Makefile	2005-08-13 11:29:33.000000000 +0200
@@ -1,12 +1,12 @@
 # $FreeBSD: src/lib/libcam/Makefile,v 1.12 2004/02/05 22:44:22 ru Exp $
 
 LIB=		cam
-SHLIBDIR?=	/lib
+SHLIB_MAJOR=    0
+SHLIBDIR?=	/usr/lib
 SRCS=		camlib.c scsi_cmdparse.c scsi_all.c scsi_da.c scsi_sa.c cam.c
 INCS=		camlib.h
 
-DPADD=		${LIBSBUF}
-LDADD+=		-lsbuf
+LDADD+=		-L../libsbuf/ -lsbuf
 
 MAN=		cam.3 cam_cdbparse.3
 
@@ -34,9 +34,11 @@
 		cam_cdbparse.3 csio_encode_visit.3 \
 		cam_cdbparse.3 buff_encode_visit.3
 
-.PATH:		${.CURDIR}/../../sys/cam/scsi ${.CURDIR}/../../sys/cam
+KERNEL=		${.CURDIR}/../kernel
 
-SDIR=		${.CURDIR}/../../sys
+.PATH:		${KERNEL}/sys/cam/scsi ${KERNEL}/sys/cam
+
+SDIR=		${KERNEL}/sys
 CFLAGS+=	-I${.CURDIR} -I${SDIR}
 
 .include <bsd.lib.mk>
--- lib/libcam/camlib.h~	2006-03-29 19:40:09.000000000 +0200
+++ lib/libcam/camlib.h	2006-03-29 19:41:25.000000000 +0200
@@ -150,13 +150,11 @@
 /*
  * Buffer encoding/decoding routines, from the old SCSI library.
  */
-int csio_decode(struct ccb_scsiio *csio, const char *fmt, ...)
-		__printflike(2, 3);
+int csio_decode(struct ccb_scsiio *csio, const char *fmt, ...);
 int csio_decode_visit(struct ccb_scsiio *csio, const char *fmt,
 		      void (*arg_put)(void *, int, void *, int, char *),
 		      void *puthook);
-int buff_decode(u_int8_t *buff, size_t len, const char *fmt, ...)
-		__printflike(3, 4);
+int buff_decode(u_int8_t *buff, size_t len, const char *fmt, ...);
 int buff_decode_visit(u_int8_t *buff, size_t len, const char *fmt,
 		      void (*arg_put)(void *, int, void *, int, char *),
 		      void *puthook);
@@ -168,8 +166,7 @@
 		     int timeout, const char *cmd_spec,
 		     int (*arg_get)(void *hook, char *field_name),
 		     void *gethook);
-int csio_encode(struct ccb_scsiio *csio, const char *fmt, ...)
-		__printflike(2, 3);
+int csio_encode(struct ccb_scsiio *csio, const char *fmt, ...);
 int buff_encode_visit(u_int8_t *buff, size_t len, const char *fmt,
 		      int (*arg_get)(void *hook, char *field_name),
 		      void *gethook);
