
Status: in BTS.

diff -ur gst-plugins0.8-0.8.6.old/debian/build-deps.in gst-plugins0.8-0.8.6/debian/build-deps.in
--- gst-plugins0.8-0.8.6.old/debian/build-deps.in	2004-12-17 20:44:46.000000000 +0100
+++ gst-plugins0.8-0.8.6/debian/build-deps.in	2004-12-17 21:14:48.000000000 +0100
@@ -1,4 +1,5 @@
 @GST_LIB_DEV_DEP@
+@GST_EXTRA_BUILD_DEPENDS@
 aalib1-dev (>= 1.4p5)
 autotools-dev
 cdbs (>= 0.4.20)
@@ -9,11 +10,8 @@
 liba52-0.7.4-dev
 libarts1-dev (>= 1.1.0) | arts-dev (>= 1.1.0.cvs20021104-2)
 libartsc0-dev
-libasound2-dev (>= 0.9.0)
 libaudiofile-dev (>= 0.2.3)
-libavc1394-dev
 libcaca-dev
-libcdparanoia0-dev (>= 3a9.8)
 libdts-dev
 libdv4-dev | libdv-dev
 libdvdnav-dev (>= 0.1.9)
@@ -34,7 +32,6 @@
 liboil0.2-dev (>= 0.2.2)
 libpango1.0-dev
 libpng12-0-dev
-libraw1394-dev
 libsdl1.2-dev (>= 1.2.4)
 libsidplay1-dev (>= 1.36.47)
 libspeex-dev (>= 1.0.rel.4)
@@ -43,6 +40,7 @@
 libvorbis-dev (>= 1.0.0-2)
 libxml2-dev (>= 2.4.23)
 pkg-config (>= 0.11.0)
+type-handling (>= 0.2.1)
 xlibs-dev (>= 4.1.0)
 xlibs-pic (>= 4.1.0)
 zlib1g-dev (>= 1:1.1.4)
diff -ur gst-plugins0.8-0.8.6.old/debian/control.in gst-plugins0.8-0.8.6/debian/control.in
--- gst-plugins0.8-0.8.6.old/debian/control.in	2004-12-17 20:44:46.000000000 +0100
+++ gst-plugins0.8-0.8.6/debian/control.in	2004-12-17 20:47:23.000000000 +0100
@@ -104,7 +104,7 @@
  http://aa-project.sourceforge.net/aalib/
 
 Package: @GST_PKGNAME@-alsa
-Architecture: any
+Architecture: @linux-gnu@
 Section: libs
 Depends: ${shlibs:Depends}
 Provides: @GST_PKGNAME@-audiosink
@@ -148,7 +148,7 @@
  http://sam.zoy.org/projects/libcaca/
 
 Package: @GST_PKGNAME@-cdparanoia
-Architecture: any
+Architecture: @linux-gnu@
 Section: libs
 Depends: ${shlibs:Depends}
 Description: cdparanoia plugin for GStreamer
diff -ur gst-plugins0.8-0.8.6.old/debian/gstreamer-dv.install gst-plugins0.8-0.8.6/debian/gstreamer-dv.install
--- gst-plugins0.8-0.8.6.old/debian/gstreamer-dv.install	2004-12-17 20:44:46.000000000 +0100
+++ gst-plugins0.8-0.8.6/debian/gstreamer-dv.install	2004-12-17 20:47:23.000000000 +0100
@@ -1,2 +1,2 @@
-debian/tmp/usr/lib/gstreamer-@GST_ABI@/libgst1394.so
+@1394@
 debian/tmp/usr/lib/gstreamer-@GST_ABI@/libgstdvdec.so
diff -ur gst-plugins0.8-0.8.6.old/debian/gstreamer-misc.install gst-plugins0.8-0.8.6/debian/gstreamer-misc.install
--- gst-plugins0.8-0.8.6.old/debian/gstreamer-misc.install	2004-12-17 20:44:46.000000000 +0100
+++ gst-plugins0.8-0.8.6/debian/gstreamer-misc.install	2004-12-17 20:47:23.000000000 +0100
@@ -1,3 +1,7 @@
+@video4linux@
+@video4linux2@
+@vcdsrc@
+@cdplayer@
 debian/tmp/usr/lib/gstreamer-@GST_ABI@/libgstac3parse.so
 debian/tmp/usr/lib/gstreamer-@GST_ABI@/libgstadder.so
 debian/tmp/usr/lib/gstreamer-@GST_ABI@/libgstalaw.so
@@ -10,7 +14,6 @@
 debian/tmp/usr/lib/gstreamer-@GST_ABI@/libgstavi.so
 debian/tmp/usr/lib/gstreamer-@GST_ABI@/libgstaudioscale.so
 debian/tmp/usr/lib/gstreamer-@GST_ABI@/libgstauparse.so
-debian/tmp/usr/lib/gstreamer-@GST_ABI@/libgstcdplayer.so
 debian/tmp/usr/lib/gstreamer-@GST_ABI@/libgstcdxaparse.so
 debian/tmp/usr/lib/gstreamer-@GST_ABI@/libgstchart.so
 debian/tmp/usr/lib/gstreamer-@GST_ABI@/libgstcolorspace.so
@@ -74,10 +77,7 @@
 debian/tmp/usr/lib/gstreamer-@GST_ABI@/libgsttypefindfunctions.so
 debian/tmp/usr/lib/gstreamer-@GST_ABI@/libgsttcp.so
 debian/tmp/usr/lib/gstreamer-@GST_ABI@/libgstudp.so
-debian/tmp/usr/lib/gstreamer-@GST_ABI@/libgstvideo4linux.so
-debian/tmp/usr/lib/gstreamer-@GST_ABI@/libgstvideo4linux2.so
 debian/tmp/usr/lib/gstreamer-@GST_ABI@/libgstvbidec.so
-debian/tmp/usr/lib/gstreamer-@GST_ABI@/libgstvcdsrc.so
 debian/tmp/usr/lib/gstreamer-@GST_ABI@/libgstvideobalance.so
 debian/tmp/usr/lib/gstreamer-@GST_ABI@/libgstvideobox.so
 debian/tmp/usr/lib/gstreamer-@GST_ABI@/libgstvideocrop.so
diff -ur gst-plugins0.8-0.8.6.old/debian/rules gst-plugins0.8-0.8.6/debian/rules
--- gst-plugins0.8-0.8.6.old/debian/rules	2004-12-17 20:44:46.000000000 +0100
+++ gst-plugins0.8-0.8.6/debian/rules	2004-12-17 21:15:03.000000000 +0100
@@ -25,23 +25,45 @@
 gst_gconf_lib_dev=libgstreamer-gconf$(gst_abi)-dev
 gst_gconf_lib_dev_dep=$(gst_plugins_lib_dev) (>= $(gst_plugins_version))
 
+gst_extra_build_depends =
+gst_extra_build_depends += libasound2-dev (>= 0.9.0) [@linux-gnu@]
+gst_extra_build_depends += , libraw1394-dev [@linux-gnu@]
+gst_extra_build_depends += , libcdparanoia0-dev (>= 3a9.8) [@linux-gnu@]
+gst_extra_build_depends += , libavc1394-dev [@linux-gnu@]
+
 # The plugins are basically the same.
 # Link special names to a template file.
 # still need "*.install" to be done by hand
 
 # EXTRA_PLUGINS: See debian/README.Debian for docs
 EXTRA_PLUGINS=
-PLUGINS=a52dec aa alsa arts artsd audiofile caca cdparanoia dv dvd esd festival flac gnomevfs gsm hermes jack jpeg mad mikmod misc mpeg2dec oss sdl sid speex swfdec theora vorbis x $(EXTRA_PLUGINS)
+PLUGINS=a52dec aa arts artsd audiofile caca dv dvd esd festival flac gnomevfs gsm hermes jack jpeg mad mikmod misc mpeg2dec oss sdl sid speex swfdec theora vorbis x $(EXTRA_PLUGINS)
+ifeq ($(DEB_HOST_GNU_SYSTEM),linux)
+PLUGINS+=alsa cdparanoia
+endif
 VERSIONIZE= \
 	plugin-apps.install \
 	plugin-apps.manpages \
 
+ifeq ($(DEB_HOST_GNU_SYSTEM),linux)
+1394 = debian/tmp/usr/lib/gstreamer-$(gst_abi)/libgst1394.so
+video4linux = debian/tmp/usr/lib/gstreamer-$(gst_abi)/libgstvideo4linux.so
+video4linux2 = debian/tmp/usr/lib/gstreamer-$(gst_abi)/libgstvideo4linux2.so
+vcdsrc = debian/tmp/usr/lib/gstreamer-$(gst_abi)/libgstvcdsrc.so
+cdplayer = debian/tmp/usr/lib/gstreamer-$(gst_abi)/libgstcdplayer.so
+endif
+
 # setup links for packages
 pre-build::
 	for p in $(PLUGINS); do \
 		rm -f debian/$(gst_pkgname)-$$p.install; \
 		cat debian/gstreamer-$$p.install | \
 			sed 's/@GST_ABI@/$(gst_abi)/g' \
+			| sed "s,@1394@,$(1394),g" \
+			| sed "s,@video4linux@,$(video4linux),g" \
+			| sed "s,@video4linux2@,$(video4linux2),g" \
+			| sed "s,@vcdsrc@,$(vcdsrc),g" \
+			| sed "s,@cdplayer@,$(cdplayer),g" \
 			> debian/$(gst_pkgname)-$$p.install; \
 		\
 		rm -f debian/$(gst_pkgname)-$$p.postinst; \
@@ -101,7 +123,9 @@
 		sed 's/@GST_PLUGINS_LIB_DEV_DEP@/$(gst_plugins_lib_dev_dep)/g' | \
 		sed 's/@GST_GCONF_LIB@/$(gst_gconf_lib)/g' | \
 		sed 's/@GST_GCONF_LIB_DEV@/$(gst_gconf_lib_dev)/g' | \
-		sed 's/@GST_GCONF_LIB_DEV_DEP@/$(gst_gconf_lib_dev_dep)/g' > $@
+		sed 's/@GST_GCONF_LIB_DEV_DEP@/$(gst_gconf_lib_dev_dep)/g' | \
+		sed "s/@GST_EXTRA_BUILD_DEPENDS@/$(gst_extra_build_depends)/g" | \
+		sed "s/@linux-gnu@/`type-handling any linux-gnu`/g" > $@
 	for plugin in $(EXTRA_PLUGINS) ; do \
 		debian/extra control $$plugin | \
 			sed 's/@GST_ABI@/$(gst_abi)/g' | \
