Author: aurel32
Status: in BTS

--- kdeedu-3.4.2.orig/debian/patches/kfreebsd.diff
+++ kdeedu-3.4.2/debian/patches/kfreebsd.diff
@@ -0,0 +1,104 @@
+--- kdeedu/kstars/kstars/indi/fli/libfli-usb.h.orig	2005-09-02 11:29:44.000000000 +0200
++++ kdeedu/kstars/kstars/indi/fli/libfli-usb.h	2005-09-02 11:30:09.000000000 +0200
+@@ -50,7 +50,7 @@
+ #define unix_bulkwrite linux_bulkwrite
+ #define unix_bulkread linux_bulkread
+ 
+-#elif defined(__FreeBSD__) || defined(__NetBSD__)
++#elif defined(__FreeBSD__) || defined(__FreeBSD_kernel__) || defined(__NetBSD__)
+ #define unix_bulkwrite bsd_bulkwrite
+ #define unix_bulkread bsd_bulkread
+ 
+--- kdeedu/kstars/kstars/indi/fli/libfli-sys.h.orig	2005-09-02 11:29:32.000000000 +0200
++++ kdeedu/kstars/kstars/indi/fli/libfli-sys.h	2005-09-02 11:26:05.000000000 +0200
+@@ -58,7 +58,7 @@
+ #define USB_GLOB "/proc/bus/usb/*/*"
+ #define SERIAL_GLOB "/dev/ttyS[0-9]*"
+ 
+-#elif defined(__FreeBSD__)
++#elif defined(__FreeBSD__) || defined (__FreeBSD_kernel__)
+ // FIXME - this does not actually work on OSX
+ 
+ #define __SYSNAME__ "FreeBSD"
+--- kdeedu/admin/libtool.m4.in.orig	23 Mar 2005 16:07:03 -0000	1.86
++++ kdeedu/admin/libtool.m4.in	13 Apr 2005 05:18:05 -0000
+@@ -1273,7 +1273,7 @@ freebsd1*)
+   dynamic_linker=no
+   ;;
+ 
+-freebsd*-gnu*)
++kfreebsd*-gnu*)
+   version_type=linux
+   need_lib_prefix=no
+   need_version=no
+@@ -2119,7 +2119,7 @@ darwin* | rhapsody*)
+   lt_cv_deplibs_check_method=pass_all
+   ;;
+ 
+-freebsd*)
++freebsd* | kfreebsd*-gnu)
+   if echo __ELF__ | $CC -E - | grep __ELF__ > /dev/null; then
+     case $host_cpu in
+     i*86 )
+@@ -2953,7 +2953,7 @@ case $host_os in
+   freebsd-elf*)
+     _LT_AC_TAGVAR(archive_cmds_need_lc, $1)=no
+     ;;
+-  freebsd*)
++  freebsd* | kfreebsd*-gnu)
+     # FreeBSD 3 and later use GNU C++ and GNU ld with standard ELF
+     # conventions
+     _LT_AC_TAGVAR(ld_shlibs, $1)=yes
+@@ -4599,7 +4599,7 @@ AC_MSG_CHECKING([for $compiler option to
+ 	    ;;
+ 	esac
+ 	;;
+-      freebsd*)
++      freebsd* | kfreebsd*-gnu)
+ 	# FreeBSD uses GNU C++
+ 	;;
+       hpux9* | hpux10* | hpux11*)
+@@ -5409,7 +5409,7 @@ EOF
+       ;;
+ 
+     # FreeBSD 3 and greater uses gcc -shared to do shared libraries.
+-    freebsd*)
++    freebsd* | kfreebsd*-gnu)
+       _LT_AC_TAGVAR(archive_cmds, $1)='$CC -shared -o $lib $compiler_flags $libobjs $deplibs'
+       _LT_AC_TAGVAR(hardcode_libdir_flag_spec, $1)='-R$libdir'
+       _LT_AC_TAGVAR(hardcode_direct, $1)=yes
+--- kdeedu/admin/ltmain.sh.orig	12 Dec 2004 19:19:25 -0000	1.67
++++ kdeedu/admin/ltmain.sh	13 Apr 2005 05:18:05 -0000
+@@ -1276,9 +1276,6 @@ EOF
+ 	    # These systems don't actually have a C or math library (as such)
+ 	    continue
+ 	    ;;
+-	  *-*-freebsd*-gnu*)
+-	    # prevent being parsed by the freebsd regexp below
+-	    ;;
+ 	  *-*-mingw* | *-*-os2*)
+ 	    # These systems don't actually have a C library (as such)
+ 	    test "X$arg" = "X-lc" && continue
+@@ -1294,9 +1291,6 @@ EOF
+ 	  esac
+ 	elif test "X$arg" = "X-lc_r"; then
+ 	 case $host in
+-	 *-*-freebsd*-gnu*)
+-	   # prevent being parsed by the freebsd regexp below
+-	   ;;
+ 	 *-*-openbsd*)
+ 	   # Do not include libc_r directly, use -pthread flag.
+ 	   continue
+@@ -3181,12 +3175,6 @@ EOF
+ 	  *-*-netbsd*)
+ 	    # Don't link with libc until the a.out ld.so is fixed.
+ 	    ;;
+-	  *-*-freebsd*-gnu*)
+-	    # Prevent $arg from being parsed by the freebsd regexp below.
+-	    if test "$build_libtool_need_lc" = "yes"; then
+-	      deplibs="$deplibs -lc"
+-	    fi
+-	    ;;
+ 	  *-*-openbsd* | *-*-freebsd*)
+ 	    # Do not include libc due to us having libc/libc_r.
+ 	    test "X$arg" = "X-lc" && continue
--- kdeedu-3.4.2.orig/debian/kstars.install.kfreebsd-i386
+++ kdeedu-3.4.2/debian/kstars.install.kfreebsd-i386
@@ -0,0 +1,25 @@
+etc/kde3/kstarsrc
+usr/bin/celestrongps
+usr/bin/fliccd
+usr/bin/indiserver
+usr/bin/lx200_16
+usr/bin/lx200autostar
+usr/bin/lx200classic
+usr/bin/lx200generic
+usr/bin/lx200gps
+usr/bin/kstars
+usr/bin/temma
+usr/include/kde/kstarsinterface.h
+usr/include/kde/simclockinterface.h
+usr/share/applications/kde/kstars.desktop
+usr/share/config.kcfg/kstars.kcfg
+usr/share/doc/kde/HTML/en/kstars/common
+usr/share/doc/kde/HTML/en/kstars/index.cache.bz2
+usr/share/doc/kde/HTML/en/kstars/*.docbook
+usr/share/doc/kde/HTML/en/kstars/*.png
+usr/share/icons/crystalsvg/16x16/apps/kstars.png
+usr/share/icons/crystalsvg/32x32/apps/kstars.png
+usr/share/icons/crystalsvg/48x48/apps/kstars.png
+usr/share/icons/crystalsvg/128x128/apps/kstars.png
+usr/share/icons/crystalsvg/scalable/apps/kstars.svgz
+../kstars.xpm usr/share/pixmaps
