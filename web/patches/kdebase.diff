Author: aurel32
Status: both clean and ugly :)
        debian/patches/27_kfreebsd.diff and debian/control parts could be merged
	debian/kcontrol.install is ugly, we have to find a solution
	kioslave/nfs/Makefile.in is ugly, we could remove it as soon as we have	a new glibc

diff -u kdebase-3.4.2/debian/control kdebase-3.4.2/debian/control
--- kdebase-3.4.2/debian/control
+++ kdebase-3.4.2/debian/control
@@ -3,7 +3,7 @@
 Priority: optional
 Maintainer: Debian Qt/KDE Maintainers <debian-qt-kde@lists.debian.org>
 Uploaders: Isaac Clerencia <isaac@debian.org>, Pierre Habouzit <madcoder@debian.org>, Christopher Martin <chrsmrtn@freeshell.org>, Adeodato Sim√≥ <asp16@alu.ua.es>, Riku Voipio <riku.voipio@iki.fi>
-Build-Depends: cdbs (>= 0.4.27), debhelper (>= 4.2.30), autotools-dev, gawk, gettext, kdelibs4-dev (>= 4:3.4.2), dbus-qt-1-dev (>= 0.23.4-5), libldap2-dev, libhal-dev, libhal-storage-dev, libncurses5-dev, libpam0g-dev, libpopt-dev, libraw1394-dev, libsensors-dev, libsmbclient-dev, libusb-dev, libxtst-dev, xutils, xlibs-static-pic, libxss-dev, libxxf86misc-dev, libxau-dev, libxdmcp-dev, libxcomposite-dev, libxdamage-dev, sharutils, texinfo
+Build-Depends: cdbs (>= 0.4.27), debhelper (>= 4.2.30), autotools-dev, gawk, gettext, kdelibs4-dev (>= 4:3.4.2), dbus-qt-1-dev (>= 0.23.4-5), libldap2-dev, libhal-dev [!kfreebsd-i386], libhal-storage-dev [!kfreebsd-i386], libncurses5-dev, libpam0g-dev, libpopt-dev, libraw1394-dev [!kfreebsd-i386], libsensors-dev [!kfreebsd-i386], libsmbclient-dev, libusb-dev, libxtst-dev, xutils, xlibs-static-pic, libxss-dev, libxxf86misc-dev, libxau-dev, libxdmcp-dev, libxcomposite-dev, libxdamage-dev, sharutils, texinfo, gcc-3.4
 Build-Depends-Indep: doxygen, qt3-doc, graphviz, gsfonts-x11
 Build-Conflicts: nvidia-glx
 Standards-Version: 3.6.2
diff -u kdebase-3.4.2/debian/kcontrol.install kdebase-3.4.2/debian/kcontrol.install
--- kdebase-3.4.2/debian/kcontrol.install
+++ kdebase-3.4.2/debian/kcontrol.install
@@ -50,8 +50,6 @@
 debian/tmp/usr/lib/kde3/kcm_input.so
 debian/tmp/usr/lib/kde3/kcm_ioslaveinfo.la
 debian/tmp/usr/lib/kde3/kcm_ioslaveinfo.so
-debian/tmp/usr/lib/kde3/kcm_joystick.la
-debian/tmp/usr/lib/kde3/kcm_joystick.so
 debian/tmp/usr/lib/kde3/kcm_kded.la
 debian/tmp/usr/lib/kde3/kcm_kded.so
 debian/tmp/usr/lib/kde3/kcm_kdm.la
@@ -98,8 +96,6 @@
 debian/tmp/usr/lib/kde3/kcm_taskbar.so
 debian/tmp/usr/lib/kde3/kcm_usb.la
 debian/tmp/usr/lib/kde3/kcm_usb.so
-debian/tmp/usr/lib/kde3/kcm_view1394.la
-debian/tmp/usr/lib/kde3/kcm_view1394.so
 debian/tmp/usr/lib/kde3/kcm_xinerama.la
 debian/tmp/usr/lib/kde3/kcm_xinerama.so
 debian/tmp/usr/lib/kde3/kcontrol.la
@@ -152,7 +148,6 @@
 debian/tmp/usr/share/applications/kde/interrupts.desktop
 debian/tmp/usr/share/applications/kde/ioports.desktop
 debian/tmp/usr/share/applications/kde/ioslaveinfo.desktop
-debian/tmp/usr/share/applications/kde/joystick.desktop
 debian/tmp/usr/share/applications/kde/kcmaccess.desktop
 debian/tmp/usr/share/applications/kde/kcmcss.desktop
 debian/tmp/usr/share/applications/kde/kcmfontinst.desktop
@@ -163,7 +158,6 @@
 debian/tmp/usr/share/applications/kde/kcmsmserver.desktop
 debian/tmp/usr/share/applications/kde/kcmtaskbar.desktop
 debian/tmp/usr/share/applications/kde/kcmusb.desktop
-debian/tmp/usr/share/applications/kde/kcmview1394.desktop
 debian/tmp/usr/share/applications/kde/kdm.desktop
 debian/tmp/usr/share/applications/kde/keys.desktop
 debian/tmp/usr/share/applications/kde/kfontview.desktop
@@ -230,7 +224,6 @@
 debian/tmp/usr/share/apps/kcmkeys/wm3.kksrc
 debian/tmp/usr/share/apps/kcmlocale/pics/background.png
 debian/tmp/usr/share/apps/kcmusb/usb.ids
-debian/tmp/usr/share/apps/kcmview1394/oui.db
 debian/tmp/usr/share/apps/kconf_update/convertShortcuts.pl
 debian/tmp/usr/share/apps/kconf_update/kaccel.upd
 debian/tmp/usr/share/apps/kconf_update/kcmdisplayrc.upd
--- kdebase-3.4.2.orig/kioslave/nfs/Makefile.in
+++ kdebase-3.4.2/kioslave/nfs/Makefile.in
@@ -122,7 +122,7 @@
 AUTOHEADER = @AUTOHEADER@
 AUTOMAKE = @AUTOMAKE@
 AWK = @AWK@
-CC = @CC@
+CC = gcc-3.4
 CCDEPMODE = @CCDEPMODE@
 CFLAGS = @CFLAGS@
 COMPILE_GL_INFO_FALSE = @COMPILE_GL_INFO_FALSE@
--- kdebase-3.4.2.orig/debian/patches/27_kfreebsd.diff
+++ kdebase-3.4.2/debian/patches/27_kfreebsd.diff
@@ -0,0 +1,143 @@
+--- kde/kcontrol/kfontinst/configure.in.in
++++ kde.patched/kcontrol/kfontinst/configure.in.in
+@@ -88,6 +88,7 @@
+         case "$host" in
+             *-*-linux*) UNAME='Linux' ;;
+             *-*-freebsd*) UNAME='FreeBSD' ;;
++            *-*-kfreebsd-gnu*) UNAME='GNU/kFreeBSD' ;;
+             *-*-netbsd*) UNAME='NetBSD' ;;
+             *-*-solaris*) UNAME='Solaris' ;;
+             *-*-irix*) UNAME='Irix' ;;
+--- kde/configure.in.in
++++ kde.patched/configure.in.in
+@@ -108,6 +108,8 @@
+      ;;
+ freebsd*) utmp_support=yes;
+      ;;
++kfreebsd*-gnu) utmp_support=yes;
++     ;;
+ *) utmp_support=no;
+ esac
+ 
+--- kde/kcontrol/usbview/configure.in.in	2005-08-28 22:59:58.000000000 +0200
++++ kde.patched/kcontrol/usbview/configure.in.in	2005-08-28 23:00:23.000000000 +0200
+@@ -5,6 +5,9 @@
+   *-*-freebsd*)
+ 	FOUND_USBVIEW=yes
+ 	;;
++  *-*-kfreebsd*-gnu)
++	FOUND_USBVIEW=yes
++	;;
+ esac
+ 
+ AM_CONDITIONAL(include_kcontrol_usbview, test "$FOUND_USBVIEW" = "yes")
+--- kde/configure.in	2005-08-29 01:43:19.000000000 +0200
++++ kde.patched/configure.in	2005-08-29 01:43:55.000000000 +0200
+@@ -173,6 +173,8 @@
+      ;;
+ freebsd*) utmp_support=yes;
+      ;;
++kfreebsd*-gnu) utmp_support=yes;
++     ;;
+ *) utmp_support=no;
+ esac
+ 
+@@ -547,6 +549,7 @@
+         case "$host" in
+             *-*-linux*) UNAME='Linux' ;;
+             *-*-freebsd*) UNAME='FreeBSD' ;;
++            *-*-kfreebsd*-gnu) UNAME='GNU/kFreeBSD' ;;
+             *-*-netbsd*) UNAME='NetBSD' ;;
+             *-*-solaris*) UNAME='Solaris' ;;
+             *-*-irix*) UNAME='Irix' ;;
+@@ -660,6 +663,9 @@
+   *-*-freebsd*)
+ 	FOUND_USBVIEW=yes
+ 	;;
++  *-*-kfreebsd*-gnu)
++	FOUND_USBVIEW=yes
++	;;
+ esac
+ 
+ AM_CONDITIONAL(include_kcontrol_usbview, test "$FOUND_USBVIEW" = "yes")
+@@ -852,6 +858,7 @@
+ case $host_os in
+ 	linux*) ac_cv_func_getutxent=no;;
+ 	darwin*) ac_cv_func_getutxent=no;;
++	kfreebsd*-gnu) ac_cv_func_getutxent=no;;
+ 	*) AC_CHECK_FUNC([getutxent]);;
+ esac
+ if test $ac_cv_func_getutxent = yes; then
+@@ -1816,6 +1816,7 @@
+ case "$host" in 
+   *-*-linux*) ksysguardd_compile=yes; UNAME='Linux' ;;
+   *-*-freebsd*) ksysguardd_compile=yes; UNAME='FreeBSD' ;;
++  *-*-kfreebsd*-gnu) ksysguardd_compile=yes; UNAME='Linux' ;;
+   *-*-netbsd*) ksysguardd_compile=yes; UNAME='NetBSD' ;;
+   *-*-solaris*) ksysguardd_compile=yes; UNAME='Solaris' ;;
+   *-*-osf*) ksysguardd_compile=yes; UNAME='Tru64' ;;
+--- kde/configure	2005-08-29 01:42:54.000000000 +0200
++++ kde.patched/configure	2005-08-29 01:44:36.000000000 +0200
+@@ -39494,6 +39494,8 @@
+      ;;
+ freebsd*) utmp_support=yes;
+      ;;
++kfreebsd*-gnu) utmp_support=yes;
++     ;;
+ *) utmp_support=no;
+ esac
+ 
+@@ -43836,6 +43838,7 @@
+         case "$host" in
+             *-*-linux*) UNAME='Linux' ;;
+             *-*-freebsd*) UNAME='FreeBSD' ;;
++            *-*-kfreebsd*-gnu) UNAME='GNU/kFreeBSD' ;;
+             *-*-netbsd*) UNAME='NetBSD' ;;
+             *-*-solaris*) UNAME='Solaris' ;;
+             *-*-irix*) UNAME='Irix' ;;
+@@ -45004,6 +45007,9 @@
+   *-*-freebsd*)
+ 	FOUND_USBVIEW=yes
+ 	;;
++  *-*-kfreebsd*-gnu)
++	FOUND_USBVIEW=yes
++	;;
+ esac
+ 
+ 
+@@ -46366,6 +46372,7 @@
+ case $host_os in
+ 	linux*) ac_cv_func_getutxent=no;;
+ 	darwin*) ac_cv_func_getutxent=no;;
++	kfreebsd*-gnu) ac_cv_func_getutxent=no;;
+ 	*) echo "$as_me:$LINENO: checking for getutxent" >&5
+ echo $ECHO_N "checking for getutxent... $ECHO_C" >&6
+ if test "${ac_cv_func_getutxent+set}" = set; then
+@@ -52915,6 +52915,7 @@
+ case "$host" in
+   *-*-linux*) ksysguardd_compile=yes; UNAME='Linux' ;;
+   *-*-freebsd*) ksysguardd_compile=yes; UNAME='FreeBSD' ;;
++  *-*-kfreebsd*-gnu) ksysguardd_compile=yes; UNAME='Linux' ;;
+   *-*-netbsd*) ksysguardd_compile=yes; UNAME='NetBSD' ;;
+   *-*-solaris*) ksysguardd_compile=yes; UNAME='Solaris' ;;
+   *-*-osf*) ksysguardd_compile=yes; UNAME='Tru64' ;;
+--- kde/kdm/configure.in.in	2005-08-29 01:43:15.000000000 +0200
++++ kde.patched/kdm/configure.in.in	2005-08-29 01:44:03.000000000 +0200
+@@ -54,6 +54,7 @@
+ case $host_os in
+ 	linux*) ac_cv_func_getutxent=no;;
+ 	darwin*) ac_cv_func_getutxent=no;;
++	kfreebsd*-gnu) ac_cv_func_getutxent=no;;
+ 	*) AC_CHECK_FUNC([getutxent]);;
+ esac
+ if test $ac_cv_func_getutxent = yes; then
+--- kde/ksysguard/configure.in.in	2005-08-29 09:59:21.000000000 +0200
++++ kde.patched/ksysguard/configure.in.in	2005-08-29 10:00:05.000000000 +0200
+@@ -3,6 +3,7 @@
+ case "$host" in 
+   *-*-linux*) ksysguardd_compile=yes; UNAME='Linux' ;;
+   *-*-freebsd*) ksysguardd_compile=yes; UNAME='FreeBSD' ;;
++  *-*-kfreebsd*-gnu) ksysguardd_compile=yes; UNAME='Linux' ;;
+   *-*-netbsd*) ksysguardd_compile=yes; UNAME='NetBSD' ;;
+   *-*-solaris*) ksysguardd_compile=yes; UNAME='Solaris' ;;
+   *-*-osf*) ksysguardd_compile=yes; UNAME='Tru64' ;;
