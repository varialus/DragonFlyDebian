#!/usr/bin/make -f
# Sample debian/rules that uses debhelper.
# GNU copyright 1997 to 1999 by Joey Hess.

# Uncomment this to turn on verbose mode.
#export DH_VERBOSE=1

# These are used for cross-compiling and for saving the configure script
# from having to guess our platform (since we know it already)
DEB_HOST_GNU_TYPE   ?= $(shell dpkg-architecture -qDEB_HOST_GNU_TYPE)
DEB_BUILD_GNU_TYPE  ?= $(shell dpkg-architecture -qDEB_BUILD_GNU_TYPE)

CFLAGS = -Wall -g

ifneq (,$(filter noopt,$(DEB_BUILD_OPTIONS)))
	CFLAGS += -O0
else
	CFLAGS += -O2
endif

include /usr/share/quilt/quilt.make

build-indep:

build-arch: patch
	dh_testdir
	
	$(MAKE) CC=gcc E=echo RANLIB=ranlib AR=ar prefix=/usr Q=@

build: build-arch build-indep

clean: unpatch
	dh_testdir
	dh_testroot
	
	[ ! -f Makefile ] || $(MAKE) clean E=echo Q=@
	
	dh_clean

install: build-arch
	dh_testdir
	dh_testroot
	dh_clean -k
	dh_installdirs -s
	
	$(MAKE) install prefix=/usr libdir=/lib DESTDIR=debian/tmp
	
	# Move all files in their corresponding package
	dh_install -s --list-missing

binary-indep:
# We have nothing to do by default.

binary-arch: build-arch install
	dh_testdir
	dh_testroot
	dh_installdocs -s
	dh_installexamples -s
	dh_installmenu -s
	dh_installcron -s
	dh_installman -s
	dh_installinfo -s
	dh_installchangelogs -s
	dh_bugfiles -s
	dh_link -s
	dh_strip -s
	dh_compress -s
	dh_fixperms -s
	dh_makeshlibs -s -V
	dh_installdeb -s
	dh_shlibdeps -s
	dh_gencontrol -s
	dh_md5sums -s
	dh_builddeb -s

binary: binary-indep binary-arch

.PHONY: clean install
.PHONY: build-indep build-arch build binary-indep binary-arch binary

